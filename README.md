# Charm Engineering Releases

This site catalogues releases from charm engineering teams. Its content is automatically generated
every 15 minutes by querying the GitHub API and scraping Launchpad pages.

The page is rendered using [Hugo](https://gohugo.io), taking data generated by [releasegen](https://github.com/jnsgruk/releasegen).

The site is published at: https://releases.juju.is

## Development / Contributing

Developing the site is relatively simple. You'll need to have [Hugo](https://gohugo.io) installed
in order to build and serve the pages.

This site doesn't use any content pages, since it relies heavily on templating. All the visual
components are in `layouts/`.

```bash
# Clone the repository
git clone https://github.com/canonical/charm-eng-releases
cd charm-eng-releases

# Build and serve the site using Hugo
hugo serve -D
```

The site should now be available at http://0.0.0.0:1313 on your local machine.

### Submitting changes

1. Create a branch from `main` (e.g. `fix-docs-grammar` or `doc-fixes`):

   ```bash
   git checkout main
   git pull origin main
   git checkout -b fix-docs-grammar
   ```

2. Commit your changes and push the branch to your fork (or to a branch in this repo if you have write access):

   ```bash
   git add README.md layouts/index.html layouts/partials/footer.html layouts/partials/js/sortable.js layouts/partials/repo.html .github/workflows/build.yml
   git commit -m "Fix documentation and comment grammar, spelling, and style"
   ```

3. Open a pull request targeting the `main` branch.
4. After review, a maintainer will merge the PR into `main`.

### Updating Data

For the live site, `data/repos.json` is automatically rebuilt from a GitHub Action, but you can
build it for local development. The file is generated using
[releasegen](https://github.com/jnsgruk/releasegen).

First, create a [GitHub token](https://github.com/settings/tokens) with `repo` permissions and copy
it somewhere safe.

```sh
# Make sure you have golang installed, if you don't already
sudo snap install go --classic

# Get the latest releasegen binary
go install github.com/jnsgruk/releasegen/cmd/releasegen@latest

# Set your GitHub API token as an environment variable
export RELEASEGEN_TOKEN=ghp_aBcDeFgHiJkLmNoPqRsTuVwXyZ

# Run the tool and redirect the output to the data file.
releasegen > data/repos.json
```
